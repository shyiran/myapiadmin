{"remainingRequest":"E:\\ApiAdmin\\node_modules\\babel-loader\\lib\\index.js!E:\\ApiAdmin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\ApiAdmin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ApiAdmin\\src\\view\\app\\list.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\ApiAdmin\\src\\view\\app\\list.vue","mtime":1635783329002},{"path":"E:\\ApiAdmin\\.babelrc","mtime":1635783328909},{"path":"E:\\ApiAdmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1635783567026},{"path":"E:\\ApiAdmin\\node_modules\\babel-loader\\lib\\index.js","mtime":1635783561745},{"path":"E:\\ApiAdmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1635783567026},{"path":"E:\\ApiAdmin\\node_modules\\vue-loader\\lib\\index.js","mtime":1635783560295}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getList as _getList, changeStatus, add, edit, del, getAppInfo, refreshAppSecretApi } from '@/api/app';\nimport { getAll } from '@/api/app-group';\n\nvar editButton = function editButton(vm, h, currentRow, index) {\n  if (vm.buttonShow.edit) {\n    return h('Button', {\n      props: {\n        type: 'primary'\n      },\n      style: {\n        margin: '0 5px'\n      },\n      on: {\n        'click': function click() {\n          getAll().then(function (response) {\n            vm.appGroup = response.data.data.list;\n            vm.formItem.id = currentRow.id;\n            vm.formItem.app_name = currentRow.app_name;\n            vm.formItem.app_info = currentRow.app_info;\n            vm.formItem.app_id = currentRow.app_id;\n            vm.formItem.app_secret = currentRow.app_secret;\n            vm.formItem.app_group = currentRow.app_group;\n            getAppInfo(currentRow.id).then(function (response) {\n              var res = response.data;\n              vm.groupInfo = res.data.groupInfo;\n              vm.groupList = res.data.apiList;\n\n              for (var _index in vm.groupInfo) {\n                if (res.data.app_detail === null || typeof res.data.app_detail[_index] === 'undefined') {\n                  vm.$set(vm.checkAllStatus, _index, false);\n                  vm.$set(vm.checkAllIndeterminate, _index, false);\n                  vm.$set(vm.formItem.app_api, _index, []);\n                } else {\n                  var hasLength = res.data.app_detail[_index].length;\n\n                  if (hasLength === 0) {\n                    vm.$set(vm.checkAllStatus, _index, false);\n                    vm.$set(vm.checkAllIndeterminate, _index, false);\n                    vm.$set(vm.formItem.app_api, _index, []);\n                  } else if (vm.groupList[_index].length === hasLength) {\n                    vm.$set(vm.checkAllStatus, _index, true);\n                    vm.$set(vm.checkAllIndeterminate, _index, false);\n                    vm.$set(vm.formItem.app_api, _index, res.data.app_detail[_index]);\n                  } else {\n                    vm.$set(vm.checkAllStatus, _index, false);\n                    vm.$set(vm.checkAllIndeterminate, _index, true);\n                    vm.$set(vm.formItem.app_api, _index, res.data.app_detail[_index]);\n                  }\n                }\n              }\n            });\n            vm.modalSetting.show = true;\n            vm.modalSetting.index = index;\n          });\n        }\n      }\n    }, vm.$t('edit_button'));\n  }\n};\n\nvar deleteButton = function deleteButton(vm, h, currentRow, index) {\n  if (vm.buttonShow.del) {\n    return h('Poptip', {\n      props: {\n        confirm: true,\n        title: '您确定要删除这条数据吗? ',\n        transfer: true\n      },\n      on: {\n        'on-ok': function onOk() {\n          del(currentRow.id).then(function (response) {\n            vm.tableData.splice(index, 1);\n            vm.$Message.success(response.data.msg);\n          });\n          currentRow.loading = false;\n        }\n      }\n    }, [h('Button', {\n      style: {\n        margin: '0 5px'\n      },\n      props: {\n        type: 'error',\n        placement: 'top',\n        loading: currentRow.isDeleting\n      }\n    }, vm.$t('delete_button'))]);\n  }\n};\n\nexport default {\n  name: 'interface_list',\n  data: function data() {\n    var _this = this;\n\n    return {\n      appGroup: [],\n      columnsList: [{\n        title: '序号',\n        type: 'index',\n        width: 65,\n        align: 'center'\n      }, {\n        title: '应用名称',\n        align: 'center',\n        key: 'app_name',\n        minWidth: 130\n      }, {\n        title: 'AppId',\n        align: 'center',\n        key: 'app_id',\n        width: 120\n      }, {\n        title: 'AppSecret',\n        align: 'center',\n        key: 'app_secret',\n        width: 310\n      }, {\n        title: '应用说明',\n        align: 'center',\n        key: 'app_info',\n        width: 160\n      }, {\n        title: '应用状态',\n        align: 'center',\n        width: 100,\n        render: function render(h, params) {\n          var vm = _this;\n          return h('i-switch', {\n            attrs: {\n              size: 'large'\n            },\n            props: {\n              'true-value': 1,\n              'false-value': 0,\n              value: params.row.app_status,\n              disabled: !vm.buttonShow.changeStatus\n            },\n            on: {\n              'on-change': function onChange(status) {\n                changeStatus(status, params.row.id).then(function (response) {\n                  vm.$Message.success(response.data.msg);\n                  vm.getList();\n                });\n              }\n            }\n          }, [h('span', {\n            slot: 'open'\n          }, vm.$t('open_choose')), h('span', {\n            slot: 'close'\n          }, vm.$t('close_choose'))]);\n        }\n      }, {\n        title: '操作',\n        align: 'center',\n        width: 200,\n        render: function render(h, params) {\n          return h('div', [editButton(_this, h, params.row, params.index), deleteButton(_this, h, params.row, params.index)]);\n        }\n      }],\n      tableData: [],\n      groupInfo: {},\n      groupList: {},\n      tableShow: {\n        currentPage: 1,\n        pageSize: 10,\n        listCount: 0\n      },\n      searchConf: {\n        type: '',\n        keywords: '',\n        status: ''\n      },\n      modalSetting: {\n        show: false,\n        loading: false,\n        index: 0\n      },\n      formItem: {\n        app_name: '',\n        app_id: '',\n        app_secret: '',\n        app_info: '',\n        app_api: {},\n        app_group: 'default',\n        id: 0\n      },\n      ruleValidate: {\n        app_name: [{\n          required: true,\n          message: '应用名称不能为空',\n          trigger: 'blur'\n        }]\n      },\n      checkAllStatus: {},\n      checkAllIndeterminate: {},\n      buttonShow: {\n        edit: true,\n        del: true,\n        changeStatus: true\n      },\n      listLoading: false\n    };\n  },\n  created: function created() {\n    var vm = this;\n    vm.getList();\n    vm.hasRule('App/edit').then(function (res) {\n      vm.buttonShow.edit = res;\n    });\n    vm.hasRule('App/del').then(function (res) {\n      vm.buttonShow.del = res;\n    });\n    vm.hasRule('App/changeStatus').then(function (res) {\n      vm.buttonShow.changeStatus = res;\n    });\n  },\n  methods: {\n    alertAdd: function alertAdd() {\n      var vm = this;\n      getAll().then(function (response) {\n        vm.appGroup = response.data.data.list;\n      });\n      getAppInfo().then(function (response) {\n        var res = response.data;\n        vm.formItem.app_id = res.data.app_id;\n        vm.formItem.app_secret = res.data.app_secret;\n        vm.groupInfo = res.data.groupInfo;\n        vm.groupList = res.data.apiList;\n\n        for (var index in vm.groupInfo) {\n          vm.$set(vm.checkAllStatus, index, false);\n          vm.$set(vm.checkAllIndeterminate, index, false);\n          vm.$set(vm.formItem.app_api, index, []);\n        }\n      });\n      vm.modalSetting.show = true;\n    },\n    submit: function submit() {\n      var vm = this;\n      vm.$refs['myForm'].validate(function (valid) {\n        if (valid) {\n          vm.modalSetting.loading = true;\n\n          if (vm.formItem.id === 0) {\n            add(vm.formItem).then(function (response) {\n              vm.$Message.success(response.data.msg);\n              vm.getList();\n              vm.cancel();\n            }).catch(function () {\n              vm.modalSetting.loading = false;\n            });\n          } else {\n            edit(vm.formItem).then(function (response) {\n              vm.$Message.success(response.data.msg);\n              vm.getList();\n              vm.cancel();\n            }).catch(function () {\n              vm.modalSetting.loading = false;\n            });\n          }\n        }\n      });\n    },\n    cancel: function cancel() {\n      this.formItem.id = 0;\n      this.$refs['myForm'].resetFields();\n      this.modalSetting.show = false;\n      this.modalSetting.loading = false;\n      this.modalSetting.index = 0;\n    },\n    changePage: function changePage(page) {\n      this.tableShow.currentPage = page;\n      this.getList();\n    },\n    changeSize: function changeSize(size) {\n      this.tableShow.pageSize = size;\n      this.getList();\n    },\n    handleCheckAll: function handleCheckAll(groupId) {\n      if (this.checkAllStatus[groupId]) {\n        this.checkAllStatus[groupId] = false;\n      } else {\n        this.checkAllStatus[groupId] = !this.checkAllStatus[groupId];\n      }\n\n      this.checkAllIndeterminate[groupId] = false;\n\n      if (this.checkAllStatus[groupId]) {\n        var vm = this;\n        this.groupList[groupId].forEach(function (item) {\n          vm.formItem.app_api[groupId].push(item.hash);\n        });\n      } else {\n        this.formItem.app_api[groupId] = [];\n      }\n    },\n    checkAllGroupChange: function checkAllGroupChange(groupId) {\n      if (this.formItem.app_api[groupId].length === this.groupList[groupId].length) {\n        this.checkAllIndeterminate[groupId] = false;\n        this.checkAllStatus[groupId] = true;\n      } else if (this.formItem.app_api[groupId].length > 0) {\n        this.checkAllIndeterminate[groupId] = true;\n        this.checkAllStatus[groupId] = false;\n      } else {\n        this.checkAllIndeterminate[groupId] = false;\n        this.checkAllStatus[groupId] = false;\n      }\n    },\n    search: function search() {\n      this.tableShow.currentPage = 1;\n      this.getList();\n    },\n    refreshAppSecret: function refreshAppSecret() {\n      var vm = this;\n      refreshAppSecretApi().then(function (response) {\n        vm.formItem.app_secret = response.data.data.app_secret;\n      });\n    },\n    getList: function getList() {\n      var vm = this;\n      vm.listLoading = true;\n\n      _getList({\n        page: vm.tableShow.currentPage,\n        size: vm.tableShow.pageSize,\n        type: vm.searchConf.type,\n        keywords: vm.searchConf.keywords,\n        status: vm.searchConf.status\n      }).then(function (response) {\n        vm.tableData = response.data.data.list;\n        vm.tableShow.listCount = response.data.data.count;\n        vm.listLoading = false;\n      });\n    },\n    doCancel: function doCancel(data) {\n      if (!data) {\n        this.formItem.id = 0;\n        this.$refs['myForm'].resetFields();\n        this.modalSetting.loading = false;\n        this.modalSetting.index = 0;\n      }\n    }\n  }\n};",{"version":3,"sources":["list.vue"],"names":[],"mappings":"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","sourcesContent":["<style lang=\"less\" scoped>\r\n  @import './list.less';\r\n</style>\r\n<template>\r\n  <div>\r\n    <Row>\r\n      <Col span=\"24\">\r\n        <Card class=\"margin-bottom-10\">\r\n          <Form inline>\r\n            <FormItem class=\"margin-bottom-0\">\r\n              <Select v-model=\"searchConf.status\" clearable placeholder='请选择状态' style=\"width:120px\">\r\n                <Option :value=\"1\">启用</Option>\r\n                <Option :value=\"0\">禁用</Option>\r\n              </Select>\r\n            </FormItem>\r\n            <FormItem class=\"margin-bottom-0\">\r\n              <Select v-model=\"searchConf.type\" clearable placeholder=\"请选择类别\" style=\"width:120px\">\r\n                <Option :value=\"1\">AppId</Option>\r\n                <Option :value=\"2\">应用名称</Option>\r\n              </Select>\r\n            </FormItem>\r\n            <FormItem class=\"margin-bottom-0\">\r\n              <Input v-model=\"searchConf.keywords\" placeholder=\"\"></Input>\r\n            </FormItem>\r\n            <FormItem class=\"margin-bottom-0\">\r\n              <Button type=\"primary\" @click=\"search\">{{ $t('find_button') }}/{{ $t('refresh_button') }}</Button>\r\n            </FormItem>\r\n          </Form>\r\n        </Card>\r\n      </Col>\r\n    </Row>\r\n    <Row>\r\n      <Col span=\"24\">\r\n        <Card>\r\n          <div class=\"margin-bottom-15\">\r\n            <Button type=\"primary\" v-has=\"'App/add'\" @click=\"alertAdd\" icon=\"md-add\">{{ $t('add_button') }}</Button>\r\n          </div>\r\n          <div>\r\n            <Table :loading=\"listLoading\" :columns=\"columnsList\" :data=\"tableData\" border disabled-hover></Table>\r\n          </div>\r\n          <div class=\"margin-top-15\" style=\"text-align: center\">\r\n            <Page :total=\"tableShow.listCount\" :current=\"tableShow.currentPage\"\r\n                  :page-size=\"tableShow.pageSize\" @on-change=\"changePage\"\r\n                  @on-page-size-change=\"changeSize\" show-elevator show-sizer show-total></Page>\r\n          </div>\r\n        </Card>\r\n      </Col>\r\n    </Row>\r\n    <Modal v-model=\"modalSetting.show\" width=\"668\" :styles=\"{top: '30px'}\" @on-visible-change=\"doCancel\">\r\n      <p slot=\"header\" style=\"color:#2d8cf0\">\r\n        <Icon type=\"md-alert\"></Icon>\r\n        <span>{{formItem.id ? '编辑' : '新增'}}应用</span>\r\n      </p>\r\n      <Form ref=\"myForm\" :rules=\"ruleValidate\" :model=\"formItem\" :label-width=\"80\">\r\n        <FormItem label=\"应用名称\" prop=\"app_name\">\r\n          <Input v-model=\"formItem.app_name\" placeholder=\"请输入应用名称\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"AppId\" prop=\"app_id\">\r\n          <Input style=\"width: 300px\" disabled v-model=\"formItem.app_id\" placeholder=\"请输入AppId\"></Input>\r\n          <Tag color=\"error\" class=\"margin-left-5\">系统自动生成，不允许修改</Tag>\r\n        </FormItem>\r\n        <FormItem label=\"AppSecret\" prop=\"app_secret\">\r\n          <Input style=\"width: 300px\" disabled v-model=\"formItem.app_secret\"\r\n                 placeholder=\"请输入AppSecret\">\r\n            <Button slot=\"append\" icon=\"md-refresh\" @click=\"refreshAppSecret\"></Button>\r\n          </Input>\r\n        </FormItem>\r\n        <FormItem label=\"应用分组\" prop=\"app_group\">\r\n          <Select v-model=\"formItem.app_group\" style=\"width:200px\">\r\n            <Option v-for=\"(v, i) in appGroup\" :value=\"v.hash\" :kk=\"i\" :key=\"v.hash\"> {{v.name}}</Option>\r\n          </Select>\r\n        </FormItem>\r\n        <FormItem label=\"应用描述\" prop=\"app_info\">\r\n          <Input v-model=\"formItem.app_info\" type=\"textarea\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"接口访问\" prop=\"app_api\">\r\n          <div class=\"api-box\">\r\n            <div class=\"api-group\" v-for=\"(apiArr, groupId) in groupList\" :key=\"groupId\">\r\n              <div style=\"border-bottom: 1px solid #e9e9e9;padding-bottom:6px;margin-bottom:6px\">\r\n                <Checkbox\r\n                    :indeterminate=\"checkAllIndeterminate[groupId]\"\r\n                    :value=\"checkAllStatus[groupId]\"\r\n                    @click.prevent.native=\"handleCheckAll(groupId)\"> {{groupInfo[groupId]}}\r\n                </Checkbox>\r\n              </div>\r\n              <CheckboxGroup v-model=\"formItem.app_api[groupId]\"\r\n                             @on-change=\"checkAllGroupChange(groupId)\">\r\n                <Checkbox :key=\"apiKey\" :label=\"api.hash\" v-for=\"(api, apiKey) in apiArr\">\r\n                  {{api.info}}\r\n                </Checkbox>\r\n              </CheckboxGroup>\r\n            </div>\r\n          </div>\r\n        </FormItem>\r\n      </Form>\r\n      <div slot=\"footer\">\r\n        <Button type=\"text\" @click=\"cancel\" class=\"margin-right-10\">取消</Button>\r\n        <Button type=\"primary\" @click=\"submit\" :loading=\"modalSetting.loading\">确定</Button>\r\n      </div>\r\n    </Modal>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { getList, changeStatus, add, edit, del, getAppInfo, refreshAppSecretApi } from '@/api/app'\r\nimport { getAll } from '@/api/app-group'\r\n\r\nconst editButton = (vm, h, currentRow, index) => {\r\n  if (vm.buttonShow.edit) {\r\n    return h('Button', {\r\n      props: {\r\n        type: 'primary'\r\n      },\r\n      style: {\r\n        margin: '0 5px'\r\n      },\r\n      on: {\r\n        'click': () => {\r\n          getAll().then(response => {\r\n            vm.appGroup = response.data.data.list\r\n            vm.formItem.id = currentRow.id\r\n            vm.formItem.app_name = currentRow.app_name\r\n            vm.formItem.app_info = currentRow.app_info\r\n            vm.formItem.app_id = currentRow.app_id\r\n            vm.formItem.app_secret = currentRow.app_secret\r\n            vm.formItem.app_group = currentRow.app_group\r\n            getAppInfo(currentRow.id).then(response => {\r\n              let res = response.data\r\n              vm.groupInfo = res.data.groupInfo\r\n              vm.groupList = res.data.apiList\r\n              for (let index in vm.groupInfo) {\r\n                if (res.data.app_detail === null || typeof (res.data.app_detail[index]) === 'undefined') {\r\n                  vm.$set(vm.checkAllStatus, index, false)\r\n                  vm.$set(vm.checkAllIndeterminate, index, false)\r\n                  vm.$set(vm.formItem.app_api, index, [])\r\n                } else {\r\n                  let hasLength = res.data.app_detail[index].length\r\n                  if (hasLength === 0) {\r\n                    vm.$set(vm.checkAllStatus, index, false)\r\n                    vm.$set(vm.checkAllIndeterminate, index, false)\r\n                    vm.$set(vm.formItem.app_api, index, [])\r\n                  } else if (vm.groupList[index].length === hasLength) {\r\n                    vm.$set(vm.checkAllStatus, index, true)\r\n                    vm.$set(vm.checkAllIndeterminate, index, false)\r\n                    vm.$set(vm.formItem.app_api, index, res.data.app_detail[index])\r\n                  } else {\r\n                    vm.$set(vm.checkAllStatus, index, false)\r\n                    vm.$set(vm.checkAllIndeterminate, index, true)\r\n                    vm.$set(vm.formItem.app_api, index, res.data.app_detail[index])\r\n                  }\r\n                }\r\n              }\r\n            })\r\n            vm.modalSetting.show = true\r\n            vm.modalSetting.index = index\r\n          })\r\n        }\r\n      }\r\n    }, vm.$t('edit_button'))\r\n  }\r\n}\r\nconst deleteButton = (vm, h, currentRow, index) => {\r\n  if (vm.buttonShow.del) {\r\n    return h('Poptip', {\r\n      props: {\r\n        confirm: true,\r\n        title: '您确定要删除这条数据吗? ',\r\n        transfer: true\r\n      },\r\n      on: {\r\n        'on-ok': () => {\r\n          del(currentRow.id).then(response => {\r\n            vm.tableData.splice(index, 1)\r\n            vm.$Message.success(response.data.msg)\r\n          })\r\n          currentRow.loading = false\r\n        }\r\n      }\r\n    }, [\r\n      h('Button', {\r\n        style: {\r\n          margin: '0 5px'\r\n        },\r\n        props: {\r\n          type: 'error',\r\n          placement: 'top',\r\n          loading: currentRow.isDeleting\r\n        }\r\n      }, vm.$t('delete_button'))\r\n    ])\r\n  }\r\n}\r\n\r\nexport default {\r\n  name: 'interface_list',\r\n  data () {\r\n    return {\r\n      appGroup: [],\r\n      columnsList: [\r\n        {\r\n          title: '序号',\r\n          type: 'index',\r\n          width: 65,\r\n          align: 'center'\r\n        },\r\n        {\r\n          title: '应用名称',\r\n          align: 'center',\r\n          key: 'app_name',\r\n          minWidth: 130\r\n        },\r\n        {\r\n          title: 'AppId',\r\n          align: 'center',\r\n          key: 'app_id',\r\n          width: 120\r\n        },\r\n        {\r\n          title: 'AppSecret',\r\n          align: 'center',\r\n          key: 'app_secret',\r\n          width: 310\r\n        },\r\n        {\r\n          title: '应用说明',\r\n          align: 'center',\r\n          key: 'app_info',\r\n          width: 160\r\n        },\r\n        {\r\n          title: '应用状态',\r\n          align: 'center',\r\n          width: 100,\r\n          render: (h, params) => {\r\n            let vm = this\r\n            return h('i-switch', {\r\n              attrs: {\r\n                size: 'large'\r\n              },\r\n              props: {\r\n                'true-value': 1,\r\n                'false-value': 0,\r\n                value: params.row.app_status,\r\n                disabled: !vm.buttonShow.changeStatus\r\n              },\r\n              on: {\r\n                'on-change': function (status) {\r\n                  changeStatus(status, params.row.id).then(response => {\r\n                    vm.$Message.success(response.data.msg)\r\n                    vm.getList()\r\n                  })\r\n                }\r\n              }\r\n            }, [\r\n              h('span', {\r\n                slot: 'open'\r\n              }, vm.$t('open_choose')),\r\n              h('span', {\r\n                slot: 'close'\r\n              }, vm.$t('close_choose'))\r\n            ])\r\n          }\r\n        },\r\n        {\r\n          title: '操作',\r\n          align: 'center',\r\n          width: 200,\r\n          render: (h, params) => {\r\n            return h('div', [\r\n              editButton(this, h, params.row, params.index),\r\n              deleteButton(this, h, params.row, params.index)\r\n            ])\r\n          }\r\n        }\r\n      ],\r\n      tableData: [],\r\n      groupInfo: {},\r\n      groupList: {},\r\n      tableShow: {\r\n        currentPage: 1,\r\n        pageSize: 10,\r\n        listCount: 0\r\n      },\r\n      searchConf: {\r\n        type: '',\r\n        keywords: '',\r\n        status: ''\r\n      },\r\n      modalSetting: {\r\n        show: false,\r\n        loading: false,\r\n        index: 0\r\n      },\r\n      formItem: {\r\n        app_name: '',\r\n        app_id: '',\r\n        app_secret: '',\r\n        app_info: '',\r\n        app_api: {},\r\n        app_group: 'default',\r\n        id: 0\r\n      },\r\n      ruleValidate: {\r\n        app_name: [\r\n          { required: true, message: '应用名称不能为空', trigger: 'blur' }\r\n        ]\r\n      },\r\n      checkAllStatus: {},\r\n      checkAllIndeterminate: {},\r\n      buttonShow: {\r\n        edit: true,\r\n        del: true,\r\n        changeStatus: true\r\n      },\r\n      listLoading: false\r\n    }\r\n  },\r\n  created () {\r\n    let vm = this\r\n    vm.getList()\r\n    vm.hasRule('App/edit').then(res => {\r\n      vm.buttonShow.edit = res\r\n    })\r\n    vm.hasRule('App/del').then(res => {\r\n      vm.buttonShow.del = res\r\n    })\r\n    vm.hasRule('App/changeStatus').then(res => {\r\n      vm.buttonShow.changeStatus = res\r\n    })\r\n  },\r\n  methods: {\r\n    alertAdd () {\r\n      let vm = this\r\n      getAll().then(response => {\r\n        vm.appGroup = response.data.data.list\r\n      })\r\n      getAppInfo().then(response => {\r\n        let res = response.data\r\n        vm.formItem.app_id = res.data.app_id\r\n        vm.formItem.app_secret = res.data.app_secret\r\n        vm.groupInfo = res.data.groupInfo\r\n        vm.groupList = res.data.apiList\r\n        for (let index in vm.groupInfo) {\r\n          vm.$set(vm.checkAllStatus, index, false)\r\n          vm.$set(vm.checkAllIndeterminate, index, false)\r\n          vm.$set(vm.formItem.app_api, index, [])\r\n        }\r\n      })\r\n      vm.modalSetting.show = true\r\n    },\r\n    submit () {\r\n      let vm = this\r\n      vm.$refs['myForm'].validate((valid) => {\r\n        if (valid) {\r\n          vm.modalSetting.loading = true\r\n          if (vm.formItem.id === 0) {\r\n            add(vm.formItem).then(response => {\r\n              vm.$Message.success(response.data.msg)\r\n              vm.getList()\r\n              vm.cancel()\r\n            }).catch(() => {\r\n              vm.modalSetting.loading = false\r\n            })\r\n          } else {\r\n            edit(vm.formItem).then(response => {\r\n              vm.$Message.success(response.data.msg)\r\n              vm.getList()\r\n              vm.cancel()\r\n            }).catch(() => {\r\n              vm.modalSetting.loading = false\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n    cancel () {\r\n      this.formItem.id = 0\r\n      this.$refs['myForm'].resetFields()\r\n      this.modalSetting.show = false\r\n      this.modalSetting.loading = false\r\n      this.modalSetting.index = 0\r\n    },\r\n    changePage (page) {\r\n      this.tableShow.currentPage = page\r\n      this.getList()\r\n    },\r\n    changeSize (size) {\r\n      this.tableShow.pageSize = size\r\n      this.getList()\r\n    },\r\n    handleCheckAll (groupId) {\r\n      if (this.checkAllStatus[groupId]) {\r\n        this.checkAllStatus[groupId] = false\r\n      } else {\r\n        this.checkAllStatus[groupId] = !this.checkAllStatus[groupId]\r\n      }\r\n      this.checkAllIndeterminate[groupId] = false\r\n\r\n      if (this.checkAllStatus[groupId]) {\r\n        let vm = this\r\n        this.groupList[groupId].forEach(item => {\r\n          vm.formItem.app_api[groupId].push(item.hash)\r\n        })\r\n      } else {\r\n        this.formItem.app_api[groupId] = []\r\n      }\r\n    },\r\n    checkAllGroupChange (groupId) {\r\n      if (this.formItem.app_api[groupId].length === this.groupList[groupId].length) {\r\n        this.checkAllIndeterminate[groupId] = false\r\n        this.checkAllStatus[groupId] = true\r\n      } else if (this.formItem.app_api[groupId].length > 0) {\r\n        this.checkAllIndeterminate[groupId] = true\r\n        this.checkAllStatus[groupId] = false\r\n      } else {\r\n        this.checkAllIndeterminate[groupId] = false\r\n        this.checkAllStatus[groupId] = false\r\n      }\r\n    },\r\n    search () {\r\n      this.tableShow.currentPage = 1\r\n      this.getList()\r\n    },\r\n    refreshAppSecret () {\r\n      let vm = this\r\n      refreshAppSecretApi().then(response => {\r\n        vm.formItem.app_secret = response.data.data.app_secret\r\n      })\r\n    },\r\n    getList () {\r\n      let vm = this\r\n      vm.listLoading = true\r\n      getList({\r\n        page: vm.tableShow.currentPage,\r\n        size: vm.tableShow.pageSize,\r\n        type: vm.searchConf.type,\r\n        keywords: vm.searchConf.keywords,\r\n        status: vm.searchConf.status\r\n      }).then(response => {\r\n        vm.tableData = response.data.data.list\r\n        vm.tableShow.listCount = response.data.data.count\r\n        vm.listLoading = false\r\n      })\r\n    },\r\n    doCancel (data) {\r\n      if (!data) {\r\n        this.formItem.id = 0\r\n        this.$refs['myForm'].resetFields()\r\n        this.modalSetting.loading = false\r\n        this.modalSetting.index = 0\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n"],"sourceRoot":"src/view/app"}]}