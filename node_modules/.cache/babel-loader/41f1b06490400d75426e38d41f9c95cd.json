{"remainingRequest":"E:\\ApiAdmin\\node_modules\\babel-loader\\lib\\index.js!E:\\ApiAdmin\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\ApiAdmin\\src\\store\\module\\user.js","dependencies":[{"path":"E:\\ApiAdmin\\src\\store\\module\\user.js","mtime":1635783328998},{"path":"E:\\ApiAdmin\\.babelrc","mtime":1635783328909},{"path":"E:\\ApiAdmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1635783567026},{"path":"E:\\ApiAdmin\\node_modules\\babel-loader\\lib\\index.js","mtime":1635783561745},{"path":"E:\\ApiAdmin\\node_modules\\eslint-loader\\index.js","mtime":1635783566509}],"contextDependencies":[],"result":["import { login, logout, getUserInfo as _getUserInfo } from '@/api/user';\nimport { resetRouter } from '@/router';\nimport { setToken as _setToken, getToken } from '@/libs/util';\nimport { filterAsyncRouter } from '@/libs/router-utils';\nexport default {\n  state: {\n    userInfo: {},\n    token: getToken()\n  },\n  mutations: {\n    setUserInfo: function setUserInfo(state, userInfo) {\n      state.userInfo = userInfo;\n    },\n    setToken: function setToken(state, token) {\n      state.token = token;\n\n      _setToken(token);\n    }\n  },\n  actions: {\n    // 登录\n    handleLogin: function handleLogin(_ref, _ref2) {\n      var commit = _ref.commit;\n      var username = _ref2.username,\n          password = _ref2.password;\n      username = username.trim();\n      return new Promise(function (resolve, reject) {\n        login({\n          username: username,\n          password: password\n        }).then(function (res) {\n          sessionStorage.setItem('dynamicRouter', JSON.stringify(res.data.data.menu));\n          commit('setUserInfo', res.data.data);\n          commit('setToken', res.data.data.apiAuth);\n          commit('updateMenuList', filterAsyncRouter(res.data.data.menu));\n          resolve();\n        }).catch(function (err) {\n          reject(err);\n        });\n      });\n    },\n    // 退出登录\n    handleLogOut: function handleLogOut(_ref3) {\n      var state = _ref3.state,\n          commit = _ref3.commit;\n      return new Promise(function (resolve, reject) {\n        logout().then(function () {\n          commit('setToken', '');\n          commit('setUserInfo', {});\n          resetRouter();\n          sessionStorage.removeItem('dynamicRouter');\n          resolve();\n        }).catch(function (err) {\n          reject(err);\n        });\n      });\n    },\n    // 获取用户相关信息\n    getUserInfo: function getUserInfo(_ref4) {\n      var state = _ref4.state,\n          commit = _ref4.commit;\n\n      if (JSON.stringify(state.userInfo) !== '{}') {\n        return state.userInfo;\n      } else {\n        return new Promise(function (resolve, reject) {\n          try {\n            _getUserInfo().then(function (res) {\n              commit('setUserInfo', res.data.data);\n              resolve(res.data.data);\n            }).catch(function (err) {\n              reject(err);\n            });\n          } catch (error) {\n            reject(error);\n          }\n        });\n      }\n    }\n  }\n};",{"version":3,"sources":["E:/ApiAdmin/src/store/module/user.js"],"names":["login","logout","getUserInfo","resetRouter","setToken","getToken","filterAsyncRouter","state","userInfo","token","mutations","setUserInfo","actions","handleLogin","commit","username","password","trim","Promise","resolve","reject","then","res","sessionStorage","setItem","JSON","stringify","data","menu","apiAuth","catch","err","handleLogOut","removeItem","error"],"mappings":"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","sourcesContent":["import {\r\n  login,\r\n  logout,\r\n  getUserInfo\r\n} from '@/api/user'\r\nimport { resetRouter } from '@/router'\r\nimport { setToken, getToken } from '@/libs/util'\r\nimport { filterAsyncRouter } from '@/libs/router-utils'\r\n\r\nexport default {\r\n  state: {\r\n    userInfo: {},\r\n    token: getToken()\r\n  },\r\n  mutations: {\r\n    setUserInfo (state, userInfo) {\r\n      state.userInfo = userInfo\r\n    },\r\n    setToken (state, token) {\r\n      state.token = token\r\n      setToken(token)\r\n    }\r\n  },\r\n  actions: {\r\n    // 登录\r\n    handleLogin ({ commit }, { username, password }) {\r\n      username = username.trim()\r\n      return new Promise((resolve, reject) => {\r\n        login({ username, password }).then(res => {\r\n          sessionStorage.setItem('dynamicRouter', JSON.stringify(res.data.data.menu))\r\n          commit('setUserInfo', res.data.data)\r\n          commit('setToken', res.data.data.apiAuth)\r\n          commit('updateMenuList', filterAsyncRouter(res.data.data.menu))\r\n          resolve()\r\n        }).catch(err => {\r\n          reject(err)\r\n        })\r\n      })\r\n    },\r\n    // 退出登录\r\n    handleLogOut ({ state, commit }) {\r\n      return new Promise((resolve, reject) => {\r\n        logout().then(() => {\r\n          commit('setToken', '')\r\n          commit('setUserInfo', {})\r\n          resetRouter()\r\n          sessionStorage.removeItem('dynamicRouter')\r\n          resolve()\r\n        }).catch(err => {\r\n          reject(err)\r\n        })\r\n      })\r\n    },\r\n    // 获取用户相关信息\r\n    getUserInfo ({ state, commit }) {\r\n      if (JSON.stringify(state.userInfo) !== '{}') {\r\n        return state.userInfo\r\n      } else {\r\n        return new Promise((resolve, reject) => {\r\n          try {\r\n            getUserInfo().then(res => {\r\n              commit('setUserInfo', res.data.data)\r\n              resolve(res.data.data)\r\n            }).catch(err => {\r\n              reject(err)\r\n            })\r\n          } catch (error) {\r\n            reject(error)\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n"]}]}