{"remainingRequest":"E:\\ApiAdmin\\node_modules\\babel-loader\\lib\\index.js!E:\\ApiAdmin\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\ApiAdmin\\src\\libs\\api.request.js","dependencies":[{"path":"E:\\ApiAdmin\\src\\libs\\api.request.js","mtime":1635783328979},{"path":"E:\\ApiAdmin\\.babelrc","mtime":1635783328909},{"path":"E:\\ApiAdmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1635783567026},{"path":"E:\\ApiAdmin\\node_modules\\babel-loader\\lib\\index.js","mtime":1635783561745},{"path":"E:\\ApiAdmin\\node_modules\\eslint-loader\\index.js","mtime":1635783566509}],"contextDependencies":[],"result":["import _classCallCheck from \"E:/ApiAdmin/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:/ApiAdmin/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport config from '@/config';\nimport axios from 'axios';\nimport iView from 'view-design';\nimport { setToken, getToken } from '@/libs/util';\nimport router from '@/router';\nexport var baseUrl = (process.env.NODE_ENV === 'development' ? config.baseUrl.dev : config.baseUrl.pro) + 'admin/';\n\nvar HttpRequest = /*#__PURE__*/function () {\n  function HttpRequest(baseUrl) {\n    _classCallCheck(this, HttpRequest);\n\n    this.baseUrl = baseUrl;\n  }\n\n  _createClass(HttpRequest, [{\n    key: \"interceptors\",\n    value: function interceptors(instance) {\n      // 请求拦截\n      instance.interceptors.request.use(function (config) {\n        return config;\n      }, function (error) {\n        return Promise.reject(error);\n      }); // 响应拦截\n\n      instance.interceptors.response.use(function (res) {\n        var data = res.data,\n            status = res.status;\n\n        if (data.code < 0) {\n          if (data.code === -14) {\n            setToken('');\n            router.push({\n              name: 'login'\n            });\n          } else {\n            iView.Message.error(data.msg);\n          }\n\n          throw new Error(data.msg);\n        } else {\n          return {\n            data: data,\n            status: status\n          };\n        }\n      }, function (error) {\n        return Promise.reject(error);\n      });\n    }\n  }, {\n    key: \"request\",\n    value: function request(options) {\n      var instance = axios.create();\n      var apiAuth = getToken();\n\n      if (apiAuth === false) {\n        options = Object.assign({\n          baseURL: this.baseUrl,\n          headers: {}\n        }, options);\n      } else {\n        options = Object.assign({\n          baseURL: this.baseUrl,\n          headers: {\n            'Api-Auth': apiAuth\n          }\n        }, options);\n      }\n\n      this.interceptors(instance);\n      return instance(options);\n    }\n  }]);\n\n  return HttpRequest;\n}();\n\nvar api_axios = new HttpRequest(baseUrl);\nexport default api_axios;",{"version":3,"sources":["E:/ApiAdmin/src/libs/api.request.js"],"names":["config","axios","iView","setToken","getToken","router","baseUrl","process","env","NODE_ENV","dev","pro","HttpRequest","instance","interceptors","request","use","error","Promise","reject","response","res","data","status","code","push","name","Message","msg","Error","options","create","apiAuth","Object","assign","baseURL","headers","api_axios"],"mappings":";;AAAA,OAAOA,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,aAAlB;AACA,SAASC,QAAT,EAAmBC,QAAnB,QAAmC,aAAnC;AACA,OAAOC,MAAP,MAAmB,UAAnB;AAEA,OAAO,IAAMC,OAAO,GAAG,CAACC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,aAAzB,GAAyCT,MAAM,CAACM,OAAP,CAAeI,GAAxD,GAA8DV,MAAM,CAACM,OAAP,CAAeK,GAA9E,IAAqF,QAArG;;IAEDC,W;AACJ,uBAAaN,OAAb,EAAsB;AAAA;;AACpB,SAAKA,OAAL,GAAeA,OAAf;AACD;;;;WAED,sBAAcO,QAAd,EAAwB;AACtB;AACAA,MAAAA,QAAQ,CAACC,YAAT,CAAsBC,OAAtB,CAA8BC,GAA9B,CAAkC,UAAAhB,MAAM,EAAI;AAC1C,eAAOA,MAAP;AACD,OAFD,EAEG,UAAAiB,KAAK,EAAI;AACV,eAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,OAJD,EAFsB,CAOtB;;AACAJ,MAAAA,QAAQ,CAACC,YAAT,CAAsBM,QAAtB,CAA+BJ,GAA/B,CAAmC,UAAAK,GAAG,EAAI;AACxC,YAAQC,IAAR,GAAyBD,GAAzB,CAAQC,IAAR;AAAA,YAAcC,MAAd,GAAyBF,GAAzB,CAAcE,MAAd;;AACA,YAAID,IAAI,CAACE,IAAL,GAAY,CAAhB,EAAmB;AACjB,cAAIF,IAAI,CAACE,IAAL,KAAc,CAAC,EAAnB,EAAuB;AACrBrB,YAAAA,QAAQ,CAAC,EAAD,CAAR;AACAE,YAAAA,MAAM,CAACoB,IAAP,CAAY;AAAEC,cAAAA,IAAI,EAAE;AAAR,aAAZ;AACD,WAHD,MAGO;AACLxB,YAAAA,KAAK,CAACyB,OAAN,CAAcV,KAAd,CAAoBK,IAAI,CAACM,GAAzB;AACD;;AACD,gBAAM,IAAIC,KAAJ,CAAUP,IAAI,CAACM,GAAf,CAAN;AACD,SARD,MAQO;AACL,iBAAO;AAAEN,YAAAA,IAAI,EAAJA,IAAF;AAAQC,YAAAA,MAAM,EAANA;AAAR,WAAP;AACD;AACF,OAbD,EAaG,UAAAN,KAAK,EAAI;AACV,eAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,OAfD;AAgBD;;;WAED,iBAASa,OAAT,EAAkB;AAChB,UAAMjB,QAAQ,GAAGZ,KAAK,CAAC8B,MAAN,EAAjB;AACA,UAAIC,OAAO,GAAG5B,QAAQ,EAAtB;;AACA,UAAI4B,OAAO,KAAK,KAAhB,EAAuB;AACrBF,QAAAA,OAAO,GAAGG,MAAM,CAACC,MAAP,CAAc;AACtBC,UAAAA,OAAO,EAAE,KAAK7B,OADQ;AAEtB8B,UAAAA,OAAO,EAAE;AAFa,SAAd,EAGPN,OAHO,CAAV;AAID,OALD,MAKO;AACLA,QAAAA,OAAO,GAAGG,MAAM,CAACC,MAAP,CAAc;AACtBC,UAAAA,OAAO,EAAE,KAAK7B,OADQ;AAEtB8B,UAAAA,OAAO,EAAE;AACP,wBAAYJ;AADL;AAFa,SAAd,EAKPF,OALO,CAAV;AAMD;;AACD,WAAKhB,YAAL,CAAkBD,QAAlB;AACA,aAAOA,QAAQ,CAACiB,OAAD,CAAf;AACD;;;;;;AAGH,IAAMO,SAAS,GAAG,IAAIzB,WAAJ,CAAgBN,OAAhB,CAAlB;AACA,eAAe+B,SAAf","sourcesContent":["import config from '@/config'\r\nimport axios from 'axios'\r\nimport iView from 'view-design'\r\nimport { setToken, getToken } from '@/libs/util'\r\nimport router from '@/router'\r\n\r\nexport const baseUrl = (process.env.NODE_ENV === 'development' ? config.baseUrl.dev : config.baseUrl.pro) + 'admin/'\r\n\r\nclass HttpRequest {\r\n  constructor (baseUrl) {\r\n    this.baseUrl = baseUrl\r\n  }\r\n\r\n  interceptors (instance) {\r\n    // 请求拦截\r\n    instance.interceptors.request.use(config => {\r\n      return config\r\n    }, error => {\r\n      return Promise.reject(error)\r\n    })\r\n    // 响应拦截\r\n    instance.interceptors.response.use(res => {\r\n      const { data, status } = res\r\n      if (data.code < 0) {\r\n        if (data.code === -14) {\r\n          setToken('')\r\n          router.push({ name: 'login' })\r\n        } else {\r\n          iView.Message.error(data.msg)\r\n        }\r\n        throw new Error(data.msg)\r\n      } else {\r\n        return { data, status }\r\n      }\r\n    }, error => {\r\n      return Promise.reject(error)\r\n    })\r\n  }\r\n\r\n  request (options) {\r\n    const instance = axios.create()\r\n    let apiAuth = getToken()\r\n    if (apiAuth === false) {\r\n      options = Object.assign({\r\n        baseURL: this.baseUrl,\r\n        headers: {}\r\n      }, options)\r\n    } else {\r\n      options = Object.assign({\r\n        baseURL: this.baseUrl,\r\n        headers: {\r\n          'Api-Auth': apiAuth\r\n        }\r\n      }, options)\r\n    }\r\n    this.interceptors(instance)\r\n    return instance(options)\r\n  }\r\n}\r\n\r\nconst api_axios = new HttpRequest(baseUrl)\r\nexport default api_axios\r\n"]}]}